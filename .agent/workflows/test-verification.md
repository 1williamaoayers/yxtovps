# 🧪 测试验证工作流

## 目标
确保所有代码修改都经过真实验证，杜绝"应该可以"、"待验证"等未经证实的结论。

## 适用场景
- 修改代码后
- 添加新功能后
- 修复 Bug 后
- 部署前检查

---

## 📋 验证检查清单

### 1️⃣ 准备阶段

- [ ] 确认要测试的功能/修改点
- [ ] 检查是否有现有的测试脚本
- [ ] 准备测试数据（如果需要）

### 2️⃣ 执行测试

根据项目类型选择对应的测试方法：

#### Python 项目
```bash
# 运行单元测试
python -m pytest

# 运行特定文件
python -m pytest tests/test_xxx.py

# 直接运行脚本验证
python your_script.py
```

#### Node.js 项目
```bash
# 运行测试套件
npm test

# 运行特定测试
npm test -- test_name

# 启动开发服务器验证
npm run dev
```

#### Web 应用
```bash
# 启动服务
npm start / python manage.py runserver

# 浏览器访问
http://localhost:端口号

# API 测试
curl -X GET http://localhost:端口/api/endpoint
```

### 3️⃣ 收集证据

**必须捕获以下至少一项：**

- [ ] 终端输出截图/日志
- [ ] 测试通过的绿色勾勾
- [ ] API 返回的 JSON 数据
- [ ] 浏览器截图
- [ ] 数据库查询结果

**记录位置：**
- 简要结果 → `TODO.md`
- 详细日志 → `notes.md`

### 4️⃣ 验证标准

**✅ 通过标准：**
- 没有报错信息
- 功能按预期工作
- 输出结果正确
- 性能可接受

**❌ 失败标准：**
- 有任何报错
- 功能不符合预期
- 输出结果错误
- 性能严重下降

### 5️⃣ 记录结果

**如果测试通过：**
1. 在 `TODO.md` 中打勾 `[x]`
2. 在 `notes.md` 中记录：
   ```
   ✅ 测试通过 - [功能名称]
   - 测试命令: xxx
   - 测试结果: xxx
   - 验证时间: 2026-01-20 10:30
   ```

**如果测试失败：**
1. **不要**在 `TODO.md` 中打勾
2. 在 `notes.md` 中详细记录：
   ```
   ❌ 测试失败 - [功能名称]
   - 测试命令: xxx
   - 报错信息: [完整错误日志]
   - 失败原因分析: xxx
   - 下一步计划: xxx
   ```

---

## 🚫 禁止行为

- ❌ 不运行就说"应该可以"
- ❌ 看到报错但说"问题不大"
- ❌ 测试未通过就在 TODO 打勾
- ❌ 只测试部分功能就说"全部完成"

## ✅ 必须行为

- ✅ 每次修改代码后都要测试
- ✅ 捕获真实的测试输出
- ✅ 记录详细的测试日志
- ✅ 测试通过后才能汇报完成

---

## 📝 测试模板

### 快速测试记录模板（复制到 notes.md）

```
---
## 🧪 测试记录 - [功能名称]
**时间**: 2026-01-20 10:30
**测试人**: Kiro

### 测试内容
- 功能: xxx
- 修改点: xxx

### 测试步骤
1. xxx
2. xxx

### 测试结果
- 状态: ✅ 通过 / ❌ 失败
- 输出: 
```
[粘贴实际输出]
```

### 结论
xxx
---
```

---

## 💡 提示

- 对于长时间运行的测试（>3分钟），使用分段检查
- 对于 Web 应用，同时测试功能和界面
- 对于 API，测试正常情况和异常情况
- 保存所有测试证据，方便后续排查问题
