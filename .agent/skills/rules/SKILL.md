---
name: rule-enforcer
description: 强制执行项目规则的技能。此技能在每次对话开始时自动触发，确保 Claude 严格遵循 .antigravityrules 文件中定义的所有规则。触发条件：(1) 任何新对话开始时，(2) 用户说"继续"或"Continue"时，(3) 任何需要写代码、修改文件或执行任务时。此技能确保：中文输出、双核记忆系统、开工仪式、验证协议、存档协议的严格执行。
---

# 规则执行器 (Rule Enforcer)

## 概述

此技能确保你在此项目中的每个操作都严格遵循 `.antigravityrules` 中定义的规则。

## 🚨 强制执行协议

### 1. 开工仪式（每次对话必须执行）

**在回复任何用户请求之前，必须完成以下步骤：**

```
□ 读取 .antigravityrules        → 自我校准，确认规则
□ 读取 TODO.md                 → 获取"永久警告"和"当前任务"
□ 读取 notes.md (最后100行)     → 寻找"SESSION HANDOVER"接续上下文
□ 向用户汇报                   → 打招呼 + 上次进度 + 今日目标
```

**如果用户说"继续"或"Continue"：** 假设上次会话崩溃，从 TODO.md 最后未完成项继续。

### 2. 语言锁 (Language Lock)

**所有输出必须使用中文：**
- ✅ 计划、任务描述、用户通知、注释 → 中文
- ✅ 仅允许：代码变量名、API名称、特定英文术语
- ❌ 禁止：整段英文 Plan、英文一级标题
- ⚠️ 输出前自检："这是中文吗？"

### 3. 双核记忆系统

| 文件 | 定位 | 内容 |
|------|------|------|
| **TODO.md** | 战略看板 | `[!]` 永久警告、`[x]` 已完成、`[ ]` 当前任务 |
| **notes.md** | 施工日志 | 调试日志、交接文档、临时思考 |

**规则**：
- TODO = 精简，只放里程碑
- notes = 所有细节，不要污染 TODO

### 4. 验证协议 (最高优先级)

**禁止行为：**
- ❌ 使用将来时（"待验证"、"应该可以"）
- ❌ 测试未通过就打勾
- ❌ 没拿到结果就汇报

**必须行为：**
- ✅ 等待真实输出（日志/截图/数据）
- ✅ 完成即停止，等待反馈

### 5. 存档协议 (Session Handover)

**当用户说"暂停"、"下班"或任务完成时：**

1. 更新 `TODO.md` → 打勾完成项
2. 在 `notes.md` 末尾追加：
   ```
   ## SESSION HANDOVER - [时间]
   - **进度**: (大白话描述)
   - **卡点**: (如有报错贴这里)
   - **交接指令**: (下一步该干嘛)
   ```
3. 通知用户："存档完毕。进度在 TODO，细节在 notes。下次直接叫我继续。"

## 座右铭

```
Show, don't tell   — 用结果说话，不是承诺
Wait, don't assume — 等待完成，不要猜测成功
Fix, don't report partial — 完全修复后再报告
Read before work   — 先读 notes.md 和 TODO.md 再开工
```

## 违规后果

如果违反规则：
1. 立即停止当前操作
2. 在 `notes.md` 写反省
3. 向用户道歉并说明改进措施
